<h1 align="center">
  ZK-Distributed-Lock
</h1>


## Description
[![pipeline status]()
[![coverage report]()

This project implements a Distributed Lock system using Zookeeper.
The Project Allows you to acquire lock and to the task while other resources won't be able to acquire it at the same time.

Read more about zookeeper at.
https://zookeeper.apache.org/
## Contents

- [Description](#description)
- [Contents](#contents)
- [Prerequisites](#prerequisites)
- [Install](#install)
- [Usage](#usage)
- [Testing](#testing)
- [Team](#team)
- [License](#license)

## Getting_Started

### Prerequisites
This project requires Node.js 10 or later.


## Install
Install all required packages with
```
npm i zk-distributed-lock
```
Now compile the typescript code:
```
npm run build
```
## Usage
Create an instance of the DistributedLock class
```
  this.lock = new DistributedLock(zkConnectString, this.lockPath);

```
Register the events handler if you want.

Acquire and release the lock the Lock,
```
    await this.lock.acquireLock( (error) => {
      if (error) {
        console.error('Failed to acquire lock:', error);
        return;
      }

      console.log('Lock acquired, doing some work...');
      this.response = "Lock Acquired";
      // Do some work here...

      this.lock.releaseLock(this.lockPath, (error) => {
        if (error) {
          console.error('Failed to release lock:', error);
          return 'Failed to release lock:';
        } else {
          console.log('Lock released');
          this.response = "Lock released";

          return 'task done';
        }
      });
      return 'task done';
    });
```

After this even if multiple Instances of your applications are running still only one resource will be able to acquire the lock.

## Testing

```
npm run test:exit

```

### Unit Tests
Unit tests are using
* [Mocha](https://www.npmjs.com/package/mocha) as framework
* [chai](https://www.npmjs.com/package/chai) as assertion library
* [nyc](https://www.npmjs.com/package/nyc) for test coverage detection.

In order to run just the mocha tests, use
```
npm run test
```
In order both run unit tests and test coverage detection, use:
```
npm run test:ci
```
Both command will automatically build the project before testing. Unit test results are reported by [mochawesome](https://www.npmjs.com/package/mochawesome) in html format and stored in the root folder under /mochawesome-report.
The coverage report can be found in html format in /coverage


## Team

- Kunal Burangi [(@Kunal Burangi)](https://github.com/KunalBurangi/)


## License

[MIT](/blob/master/license.md)

This repository was generated by [tmpo](https://github.com/perryrh0dan/tmpo)
